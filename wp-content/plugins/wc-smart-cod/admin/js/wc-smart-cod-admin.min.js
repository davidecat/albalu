jQuery(document).ready((function(e){var t=e("#mainform"),a=e(".woocommerce-save-button"),n=e(".wc-smart-cod-group"),r=e(".wc-smartcod-categories, .wc-smartcod-products"),i=e(".wc-smartcod-products.wc-smart-cod-group"),c=e(".wc-smart-cod-restriction"),s=e(".wc-smart-cod-percentage"),o=e("body"),d=e("#woocommerce_cod_restriction_settings"),l=e("#woocommerce_cod_fee_settings"),_=e(".wsc-message-switcher"),m=e(".wsc-message"),u=e(".wc-smart-cod-pro-field"),h={},p={},g="";smart_cod_variables.hasOwnProperty("restriction_settings")&&(h=smart_cod_variables.restriction_settings),smart_cod_variables.hasOwnProperty("fee_settings")&&(p=smart_cod_variables.fee_settings),smart_cod_variables.hasOwnProperty("pro_site_url")&&(g=smart_cod_variables.pro_site_url);var f={init:function(){d.parents("tr").addClass("hidden"),l.parents("tr").addClass("hidden"),c.each((function(t,a){f.enableConditional(e(this))})),s.each((function(t,a){f.enablePercentage(e(this))})),u.each((function(t,a){f.enableProField(e(this))})),o.on("change",".wc-smart-cod-percantage-switcher",f.switchFee),o.on("click",".wc-smart-cod-mode",f.switchMode),a.click((function(e){f.validateFields(n)||e.preventDefault()})),r.each((function(t,a){f.initSelect2(e(this))})),f.fixSelect2Bug(i),_.on("change",f.changeMessageVisibility)},changeMessageVisibility:function(t){e(this);var a=e(this).val();m.addClass("hidden"),e('.wsc-message[data-restriction="'+a+'"]').removeClass("hidden")},isObjectEmpty:function(e){var t;for(t in e)return!1;return!0},switchMode:function(t){t.preventDefault();var a=e(this),n=a.data("mode"),r="enable"===n?"disable":"enable",i=a.parents("tr").find(".wc-smart-cod-restriction").data("name");"enable"!==n&&"disable"!==n||(h[i]="enable"===r?1:0,d.val(JSON.stringify(h)),a.html(r),a.data("mode",r))},switchFee:function(t){var a=e(this),n=a.prev(),r=a.val(),i=n.attr("name");p[i.slice(16)]=r,l.val(JSON.stringify(p))},enablePercentage:function(t){var a=t.parents("fieldset"),n=e('<select class="wc-smart-cod-percantage-switcher"><option value="fixed">Fixed</option><option value="percentage">%</option></select>'),r="0",i=t.attr("name").slice(16);a.find("input").is(":disabled")&&n.prop("disabled",!0),p.hasOwnProperty(i)?r=p[i]:p[i]=r="fixed",n.val(r),a.append(n)},enableConditional:function(e){var t=e.parents("tr").find("th").find("label");if(t.length>0){var a=t.contents().get(0).nodeValue,n=a.trim().split(" ");if(n[0]){var r=n[0].toLowerCase();switch(r){case"enable":case"disable":var i=e.attr("name"),c=e.data("name");t.contents().get(0).nodeValue=t.text().replace(a,""),n.shift(),t.prepend('<a class="wc-smart-cod-mode" href="#" data-mode="'+r+'" data-input-name="'+i+'">'+r+"</a> "+n.join(" ")),h.hasOwnProperty(c)||(h[c]="enable"===r?1:0)}}}},enableProField:function(e){var t=e.parents("tr").find("th");t.length>0&&t.append('<p class="pro-badge"><a href="'+g+'" target="_blank">ðŸš€ Available in PRO</a></p>')},fixSelect2Bug:function(e){var t=e.data("select2");t&&t.on("results:message",(function(e){this.dropdown._resizeDropdown(),this.dropdown._positionDropdown()}))},initSelect2:function(t){var a,n=t.data("action")||"woocommerce_json_search_categories";"wcsmartcod_json_search_categories"===n?a=smart_cod_variables.enhanced_select.search_categories_nonce:"woocommerce_json_search_products_and_variations"===n&&(a=smart_cod_variables.enhanced_select.search_products_nonce);var r={allowClear:!!t.data("allow_clear"),placeholder:t.data("placeholder"),minimumInputLength:t.data("minimum_input_length")?t.data("minimum_input_length"):"3",escapeMarkup:function(e){return e},ajax:{url:smart_cod_variables.enhanced_select.ajax_url,dataType:"json",delay:250,data:function(e){return{term:e.term,action:n,security:a,exclude:t.data("exclude"),include:t.data("include"),limit:t.data("limit")}},processResults:function(t){var a=[];return t&&e.each(t,(function(e,t){a.push({id:e,text:t})})),{results:a}},cache:!0}};r=e.extend(r,f.getEnhancedSelectFormatString()),t.select2(r).addClass("enhanced")},validateFields:function(a){t.find(".field-error").remove();return a.each((function(t,a){if("woocommerce_cod_include_restrict_postals"!==a.id&&"woocommerce_cod_restrict_postals"!==a.id)return!0;var n=e(this),r=n.val()?n.val().replace(/\s/g,""):n.val();n.val(r)})),!0},getEnhancedSelectFormatString:function(){return{language:{errorLoading:function(){return smart_cod_variables.enhanced_select.i18n_searching},inputTooLong:function(e){var t=e.input.length-e.maximum;return 1===t?smart_cod_variables.enhanced_select.i18n_input_too_long_1:smart_cod_variables.enhanced_select.i18n_input_too_long_n.replace("%qty%",t)},inputTooShort:function(e){var t=e.minimum-e.input.length;return 1===t?smart_cod_variables.enhanced_select.i18n_input_too_short_1:smart_cod_variables.enhanced_select.i18n_input_too_short_n.replace("%qty%",t)},loadingMore:function(){return smart_cod_variables.enhanced_select.i18n_load_more},maximumSelected:function(e){return 1===e.maximum?smart_cod_variables.enhanced_select.i18n_selection_too_long_1:smart_cod_variables.enhanced_select.i18n_selection_too_long_n.replace("%qty%",e.maximum)},noResults:function(){return smart_cod_variables.enhanced_select.i18n_no_matches},searching:function(){return smart_cod_variables.enhanced_select.i18n_searching}}}}};f.init()}));